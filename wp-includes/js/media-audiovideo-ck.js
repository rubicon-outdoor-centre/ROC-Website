(function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<r.length;o++)i(r[o]);return i})({1:[function(e,t,n){var r=wp.media,i=window._wpmejsSettings||{},s=window._wpMediaViewsL10n||{};wp.media.mixin={mejsSettings:i,removeAllPlayers:function(){var e;if(window.mejs&&window.mejs.players)for(e in window.mejs.players){window.mejs.players[e].pause();this.removePlayer(window.mejs.players[e])}},removePlayer:function(e){var t,n;if(!e.options)return;for(t in e.options.features){n=e.options.features[t];if(e["clean"+n])try{e["clean"+n](e)}catch(r){}}e.isDynamic||e.$node.remove();"native"!==e.media.pluginType&&e.$media.remove();delete window.mejs.players[e.id];e.container.remove();e.globalUnbind();delete e.node.player},unsetPlayers:function(){if(this.players&&this.players.length){_.each(this.players,function(e){e.pause();wp.media.mixin.removePlayer(e)});this.players=[]}}};wp.media.playlist=new wp.media.collection({tag:"playlist",editTitle:s.editPlaylistTitle,defaults:{id:wp.media.view.settings.post.id,style:"light",tracklist:!0,tracknumbers:!0,images:!0,artists:!0,type:"audio"}});wp.media.audio={coerce:wp.media.coerce,defaults:{id:wp.media.view.settings.post.id,src:"",loop:!1,autoplay:!1,preload:"none",width:400},edit:function(e){var t,n=wp.shortcode.next("audio",e).shortcode;t=wp.media({frame:"audio",state:"audio-details",metadata:_.defaults(n.attrs.named,this.defaults)});return t},shortcode:function(e){var t;_.each(this.defaults,function(t,n){e[n]=this.coerce(e,n);t===e[n]&&delete e[n]},this);t=e.content;delete e.content;return new wp.shortcode({tag:"audio",attrs:e,content:t})}};wp.media.video={coerce:wp.media.coerce,defaults:{id:wp.media.view.settings.post.id,src:"",poster:"",loop:!1,autoplay:!1,preload:"metadata",content:"",width:640,height:360},edit:function(e){var t,n=wp.shortcode.next("video",e).shortcode,r;r=n.attrs.named;r.content=n.content;t=wp.media({frame:"video",state:"video-details",metadata:_.defaults(r,this.defaults)});return t},shortcode:function(e){var t;_.each(this.defaults,function(t,n){e[n]=this.coerce(e,n);t===e[n]&&delete e[n]},this);t=e.content;delete e.content;return new wp.shortcode({tag:"video",attrs:e,content:t})}};r.model.PostMedia=e("./models/post-media.js");r.controller.AudioDetails=e("./controllers/audio-details.js");r.controller.VideoDetails=e("./controllers/video-details.js");r.view.MediaFrame.MediaDetails=e("./views/frame/media-details.js");r.view.MediaFrame.AudioDetails=e("./views/frame/audio-details.js");r.view.MediaFrame.VideoDetails=e("./views/frame/video-details.js");r.view.MediaDetails=e("./views/media-details.js");r.view.AudioDetails=e("./views/audio-details.js");r.view.VideoDetails=e("./views/video-details.js")},{"./controllers/audio-details.js":2,"./controllers/video-details.js":3,"./models/post-media.js":4,"./views/audio-details.js":5,"./views/frame/audio-details.js":6,"./views/frame/media-details.js":7,"./views/frame/video-details.js":8,"./views/media-details.js":9,"./views/video-details.js":10}],2:[function(e,t,n){var r=wp.media.controller.State,i=wp.media.view.l10n,s;s=r.extend({defaults:{id:"audio-details",toolbar:"audio-details",title:i.audioDetailsTitle,content:"audio-details",menu:"audio-details",router:!1,priority:60},initialize:function(e){this.media=e.media;r.prototype.initialize.apply(this,arguments)}});t.exports=s},{}],3:[function(e,t,n){var r=wp.media.controller.State,i=wp.media.view.l10n,s;s=r.extend({defaults:{id:"video-details",toolbar:"video-details",title:i.videoDetailsTitle,content:"video-details",menu:"video-details",router:!1,priority:60},initialize:function(e){this.media=e.media;r.prototype.initialize.apply(this,arguments)}});t.exports=s},{}],4:[function(e,t,n){var r=Backbone.Model.extend({initialize:function(){this.attachment=!1},setSource:function(e){this.attachment=e;this.extension=e.get("filename").split(".").pop();this.get("src")&&this.extension===this.get("src").split(".").pop()&&this.unset("src");_.contains(wp.media.view.settings.embedExts,this.extension)?this.set(this.extension,this.attachment.get("url")):this.unset(this.extension)},changeAttachment:function(e){this.setSource(e);this.unset("src");_.each(_.without(wp.media.view.settings.embedExts,this.extension),function(e){this.unset(e)},this)}});t.exports=r},{}],5:[function(e,t,n){var r=wp.media.view.MediaDetails,i;i=r.extend({className:"audio-details",template:wp.template("audio-details"),setMedia:function(){var e=this.$(".wp-audio-shortcode");if(e.find("source").length){e.is(":hidden")&&e.show();this.media=r.prepareSrc(e.get(0))}else{e.hide();this.media=!1}return this}});t.exports=i},{}],6:[function(e,t,n){var r=wp.media.view.MediaFrame.MediaDetails,i=wp.media.controller.MediaLibrary,s=wp.media.view.l10n,o;o=r.extend({defaults:{id:"audio",url:"",menu:"audio-details",content:"audio-details",toolbar:"audio-details",type:"link",title:s.audioDetailsTitle,priority:120},initialize:function(e){e.DetailsView=wp.media.view.AudioDetails;e.cancelText=s.audioDetailsCancel;e.addText=s.audioAddSourceTitle;r.prototype.initialize.call(this,e)},bindHandlers:function(){r.prototype.bindHandlers.apply(this,arguments);this.on("toolbar:render:replace-audio",this.renderReplaceToolbar,this);this.on("toolbar:render:add-audio-source",this.renderAddSourceToolbar,this)},createStates:function(){this.states.add([new wp.media.controller.AudioDetails({media:this.media}),new i({type:"audio",id:"replace-audio",title:s.audioReplaceTitle,toolbar:"replace-audio",media:this.media,menu:"audio-details"}),new i({type:"audio",id:"add-audio-source",title:s.audioAddSourceTitle,toolbar:"add-audio-source",media:this.media,menu:!1})])}});t.exports=o},{}],7:[function(e,t,n){var r=wp.media.view.MediaFrame.Select,i=wp.media.view.l10n,s;s=r.extend({defaults:{id:"media",url:"",menu:"media-details",content:"media-details",toolbar:"media-details",type:"link",priority:120},initialize:function(e){this.DetailsView=e.DetailsView;this.cancelText=e.cancelText;this.addText=e.addText;this.media=new wp.media.model.PostMedia(e.metadata);this.options.selection=new wp.media.model.Selection(this.media.attachment,{multiple:!1});r.prototype.initialize.apply(this,arguments)},bindHandlers:function(){var e=this.defaults.menu;r.prototype.bindHandlers.apply(this,arguments);this.on("menu:create:"+e,this.createMenu,this);this.on("content:render:"+e,this.renderDetailsContent,this);this.on("menu:render:"+e,this.renderMenu,this);this.on("toolbar:render:"+e,this.renderDetailsToolbar,this)},renderDetailsContent:function(){var e=(new this.DetailsView({controller:this,model:this.state().media,attachment:this.state().media.attachment})).render();this.content.set(e)},renderMenu:function(e){var t=this.lastState(),n=t&&t.id,r=this;e.set({cancel:{text:this.cancelText,priority:20,click:function(){n?r.setState(n):r.close()}},separateCancel:new wp.media.View({className:"separator",priority:40})})},setPrimaryButton:function(e,t){this.toolbar.set(new wp.media.view.Toolbar({controller:this,items:{button:{style:"primary",text:e,priority:80,click:function(){var e=this.controller;t.call(this,e,e.state());e.setState(e.options.state);e.reset()}}}}))},renderDetailsToolbar:function(){this.setPrimaryButton(i.update,function(e,t){e.close();t.trigger("update",e.media.toJSON())})},renderReplaceToolbar:function(){this.setPrimaryButton(i.replace,function(e,t){var n=t.get("selection").single();e.media.changeAttachment(n);t.trigger("replace",e.media.toJSON())})},renderAddSourceToolbar:function(){this.setPrimaryButton(this.addText,function(e,t){var n=t.get("selection").single();e.media.setSource(n);t.trigger("add-source",e.media.toJSON())})}});t.exports=s},{}],8:[function(e,t,n){var r=wp.media.view.MediaFrame.MediaDetails,i=wp.media.controller.MediaLibrary,s=wp.media.view.l10n,o;o=r.extend({defaults:{id:"video",url:"",menu:"video-details",content:"video-details",toolbar:"video-details",type:"link",title:s.videoDetailsTitle,priority:120},initialize:function(e){e.DetailsView=wp.media.view.VideoDetails;e.cancelText=s.videoDetailsCancel;e.addText=s.videoAddSourceTitle;r.prototype.initialize.call(this,e)},bindHandlers:function(){r.prototype.bindHandlers.apply(this,arguments);this.on("toolbar:render:replace-video",this.renderReplaceToolbar,this);this.on("toolbar:render:add-video-source",this.renderAddSourceToolbar,this);this.on("toolbar:render:select-poster-image",this.renderSelectPosterImageToolbar,this);this.on("toolbar:render:add-track",this.renderAddTrackToolbar,this)},createStates:function(){this.states.add([new wp.media.controller.VideoDetails({media:this.media}),new i({type:"video",id:"replace-video",title:s.videoReplaceTitle,toolbar:"replace-video",media:this.media,menu:"video-details"}),new i({type:"video",id:"add-video-source",title:s.videoAddSourceTitle,toolbar:"add-video-source",media:this.media,menu:!1}),new i({type:"image",id:"select-poster-image",title:s.videoSelectPosterImageTitle,toolbar:"select-poster-image",media:this.media,menu:"video-details"}),new i({type:"text",id:"add-track",title:s.videoAddTrackTitle,toolbar:"add-track",media:this.media,menu:"video-details"})])},renderSelectPosterImageToolbar:function(){this.setPrimaryButton(s.videoSelectPosterImageTitle,function(e,t){var n=[],r=t.get("selection").single();e.media.set("poster",r.get("url"));t.trigger("set-poster-image",e.media.toJSON());_.each(wp.media.view.settings.embedExts,function(t){e.media.get(t)&&n.push(e.media.get(t))});wp.ajax.send("set-attachment-thumbnail",{data:{urls:n,thumbnail_id:r.get("id")}})})},renderAddTrackToolbar:function(){this.setPrimaryButton(s.videoAddTrackTitle,function(e,t){var n=t.get("selection").single(),r=e.media.get("content");if(-1===r.indexOf(n.get("url"))){r+=['<track srclang="en" label="English" kind="subtitles" src="',n.get("url"),'" />'].join("");e.media.set("content",r)}t.trigger("add-track",e.media.toJSON())})}});t.exports=o},{}],9:[function(e,t,n){var r=wp.media.view.Settings.AttachmentDisplay,i=jQuery,s;s=r.extend({initialize:function(){_.bindAll(this,"success");this.players=[];this.listenTo(this.controller,"close",wp.media.mixin.unsetPlayers);this.on("ready",this.setPlayer);this.on("media:setting:remove",wp.media.mixin.unsetPlayers,this);this.on("media:setting:remove",this.render);this.on("media:setting:remove",this.setPlayer);this.events=_.extend(this.events,{"click .remove-setting":"removeSetting","change .content-track":"setTracks","click .remove-track":"setTracks","click .add-media-source":"addSource"});r.prototype.initialize.apply(this,arguments)},prepare:function(){return _.defaults({model:this.model.toJSON()},this.options)},removeSetting:function(e){var t=i(e.currentTarget).parent(),n;n=t.find("input").data("setting");if(n){this.model.unset(n);this.trigger("media:setting:remove",this)}t.remove()},setTracks:function(){var e="";_.each(this.$(".content-track"),function(t){e+=i(t).val()});this.model.set("content",e);this.trigger("media:setting:remove",this)},addSource:function(e){this.controller.lastMime=i(e.currentTarget).data("mime");this.controller.setState("add-"+this.controller.defaults.id+"-source")},loadPlayer:function(){this.players.push(new MediaElementPlayer(this.media,this.settings));this.scriptXhr=!1},setPlayer:function(){var e;if(this.players.length||!this.media||this.scriptXhr)return;if(this.model.get("src").indexOf("vimeo")>-1&&!("Froogaloop"in window)){e=wp.media.mixin.mejsSettings;this.scriptXhr=i.getScript(e.pluginPath+"froogaloop.min.js",_.bind(this.loadPlayer,this))}else this.loadPlayer()},setMedia:function(){return this},success:function(e){var t=e.attributes.autoplay&&"false"!==e.attributes.autoplay;"flash"===e.pluginType&&t&&e.addEventListener("canplay",function(){e.play()},!1);this.mejs=e},render:function(){r.prototype.render.apply(this,arguments);setTimeout(_.bind(function(){this.resetFocus()},this),10);this.settings=_.defaults({success:this.success},wp.media.mixin.mejsSettings);return this.setMedia()},resetFocus:function(){this.$(".embed-media-settings").scrollTop(0)}},{instances:0,prepareSrc:function(e){var t=s.instances++;_.each(i(e).find("source"),function(e){e.src=[e.src,e.src.indexOf("?")>-1?"&":"?","_=",t].join("")});return e}});t.exports=s},{}],10:[function(e,t,n){var r=wp.media.view.MediaDetails,i;i=r.extend({className:"video-details",template:wp.template("video-details"),setMedia:function(){var e=this.$(".wp-video-shortcode");if(e.find("source").length){e.is(":hidden")&&e.show();!e.hasClass("youtube-video")&&!e.hasClass("vimeo-video")?this.media=r.prepareSrc(e.get(0)):this.media=e.get(0)}else{e.hide();this.media=!1}return this}});t.exports=i},{}]},{},[1]);