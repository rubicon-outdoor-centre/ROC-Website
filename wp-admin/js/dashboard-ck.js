/* global pagenow, ajaxurl, postboxes, wpActiveEditor:true */var ajaxWidgets,ajaxPopulateWidgets,quickPressLoad;jQuery(document).ready(function(e){function i(){if(document.documentMode&&document.documentMode<9)return;e("body").append('<div class="quick-draft-textarea-clone" style="display: none;"></div>');var t=e(".quick-draft-textarea-clone"),n=e("#content"),r=n.height(),i=e(window).height()-100;t.css({"font-family":n.css("font-family"),"font-size":n.css("font-size"),"line-height":n.css("line-height"),"padding-bottom":n.css("paddingBottom"),"padding-left":n.css("paddingLeft"),"padding-right":n.css("paddingRight"),"padding-top":n.css("paddingTop"),"white-space":"pre-wrap","word-wrap":"break-word",display:"none"});n.on("focus input propertychange",function(){var s=e(this),o=s.val()+"&nbsp;",u=t.css("width",s.css("width")).text(o).outerHeight()+2;n.css("overflow-y","auto");if(u===r||u>=i&&r>=i)return;u>i?r=i:r=u;n.css("overflow","hidden");s.css("height",r+"px")})}var t=e("#welcome-panel"),n=e("#wp_welcome_panel-hide"),r;r=function(t){e.post(ajaxurl,{action:"update-welcome-panel",visible:t,welcomepanelnonce:e("#welcomepanelnonce").val()})};t.hasClass("hidden")&&n.prop("checked")&&t.removeClass("hidden");e(".welcome-panel-close, .welcome-panel-dismiss a",t).click(function(n){n.preventDefault();t.addClass("hidden");r(0);e("#wp_welcome_panel-hide").prop("checked",!1)});n.click(function(){t.toggleClass("hidden",!this.checked);r(this.checked?1:0)});ajaxWidgets=["dashboard_primary"];ajaxPopulateWidgets=function(t){function n(t,n){var r,i=e("#"+n+" div.inside:visible").find(".widget-loading");if(i.length){r=i.parent();setTimeout(function(){r.load(ajaxurl+"?action=dashboard-widgets&widget="+n+"&pagenow="+pagenow,"",function(){r.hide().slideDown("normal",function(){e(this).css("display","")})})},t*500)}}if(t){t=t.toString();e.inArray(t,ajaxWidgets)!==-1&&n(0,t)}else e.each(ajaxWidgets,n)};ajaxPopulateWidgets();postboxes.add_postbox_toggles(pagenow,{pbshow:ajaxPopulateWidgets});quickPressLoad=function(){var t=e("#quickpost-action"),n;e('#quick-press .submit input[type="submit"], #quick-press .submit input[type="reset"]').prop("disabled",!1);n=e("#quick-press").submit(function(){function t(){var t=e(".drafts ul li").first();t.css("background","#fffbe5");setTimeout(function(){t.css("background","none")},1e3)}e("#dashboard_quick_press #publishing-action .spinner").show();e('#quick-press .submit input[type="submit"], #quick-press .submit input[type="reset"]').prop("disabled",!0);e.post(n.attr("action"),n.serializeArray(),function(n){e("#dashboard_quick_press .inside").html(n);e("#quick-press").removeClass("initial-form");quickPressLoad();t();e("#title").focus()});return!1});e("#publish").click(function(){t.val("post-quickpress-publish")});e("#title, #tags-input, #content").each(function(){var t=e(this),n=e("#"+this.id+"-prompt-text");""===this.value&&n.removeClass("screen-reader-text");n.click(function(){e(this).addClass("screen-reader-text");t.focus()});t.blur(function(){""===this.value&&n.removeClass("screen-reader-text")});t.focus(function(){n.addClass("screen-reader-text")})});e("#quick-press").on("click focusin",function(){wpActiveEditor="content"});i()};quickPressLoad();e(".meta-box-sortables").sortable("option","containment","#wpwrap")});